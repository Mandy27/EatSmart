function getData(){var ref=new Firebase("https://burning-heat-9490.firebaseio.com/");ref.onAuth(function(authData){authData&&ref.child("Custom").child(authData.uid).on("value",function(snapshot){data=_.toArray(snapshot.val().Habits)},function(errorObject){data=[]})})}function parseData(){for(var today=new Date,currentTime=toSecond(today.getHours()+":"+today.getMinutes()),i=0;i<data.length;i++){var from=toSecond(data[i].from),to=toSecond(data[i].to);-1!=checkDayInterval(data[i])?data[i].next_reminder_time=calculateNextTime(currentTime,from,to,data[i].time_interval):data[i].next_reminder_time=108e3}data=_.sortBy(data,"next_reminder_time")}function reminder(){if(data.length){count>0&&(count--,parseData(data));var today=new Date,currentTime=toSecond(today.getHours()+":"+today.getMinutes());if(currentTime==data[0].next_reminder_time){var item=data.shift();Notification.requestPermission();var theBody="It's time to complete "+item.title,theIcon="../img/logo.png",theTitle="Virtue/Vice";spawnNotification(theBody,theIcon,theTitle),item.next_reminder_time=calculateNextTime(currentTime,item.from,item.to,item.time_interval),data.push(item),data=_.sortBy(data,"next_reminder_time")}}setTimeout(reminder,500)}function checkDayInterval(data){var d=new Date,day=d.getDay(),checkDay=_.findIndex(data.weekly_frequency,function(d){return d==day});return checkDay}function spawnNotification(theBody,theIcon,theTitle){var options={body:theBody,icon:theIcon},n=new Notification(theTitle,options);setTimeout(n.close.bind(n),3e3)}function toSecond(timeStr){var time=3600*timeStr.substr(0,timeStr.indexOf(":"));return time+=60*timeStr.substr(timeStr.indexOf(":")+1)}function calculateNextTime(currTime,from,to,n){if(currTime>=from&&to>=currTime&&0!=n){for(var nextTime=from,curr=currTime;curr>nextTime;)nextTime+=3600*n;if(to>=nextTime)return nextTime}return 108e3}function getData(){var ref=new Firebase("https://burning-heat-9490.firebaseio.com/");ref.onAuth(function(authData){authData&&ref.child("Custom").child(authData.uid).on("value",function(snapshot){data=_.toArray(snapshot.val().Habits)},function(errorObject){data=[]})})}function parseData(){for(var today=new Date,currentTime=toSecond(today.getHours()+":"+today.getMinutes()),i=0;i<data.length;i++){var from=toSecond(data[i].from),to=toSecond(data[i].to);-1!=checkDayInterval(data[i])?data[i].next_reminder_time=calculateNextTime(currentTime,from,to,data[i].time_interval):data[i].next_reminder_time=108e3}data=_.sortBy(data,"next_reminder_time")}function reminder(){if(console.log("Reminder function"),data.length){count>0&&(count--,parseData(data));var today=new Date,currentTime=toSecond(today.getHours()+":"+today.getMinutes());if(currentTime==data[0].next_reminder_time){var item=data.shift();Notification.requestPermission();var theBody="It's time to complete "+item.title,theIcon="../img/logo.png",theTitle="Virtue/Vice";spawnNotification(theBody,theIcon,theTitle),item.next_reminder_time=calculateNextTime(currentTime,item.from,item.to,item.time_interval),data.push(item),data=_.sortBy(data,"next_reminder_time")}}setTimeout(reminder,500)}function checkDayInterval(data){var d=new Date,day=d.getDay(),checkDay=_.findIndex(data.weekly_frequency,function(d){return d==day});return checkDay}function spawnNotification(theBody,theIcon,theTitle){var options={body:theBody,icon:theIcon},n=new Notification(theTitle,options);setTimeout(n.close.bind(n),3e3)}function toSecond(timeStr){var time=3600*timeStr.substr(0,timeStr.indexOf(":"));return time+=60*timeStr.substr(timeStr.indexOf(":")+1)}function calculateNextTime(currTime,from,to,n){if(currTime>=from&&to>=currTime&&0!=n){for(var nextTime=from,curr=currTime;curr>nextTime;)nextTime+=3600*n;if(to>=nextTime)return nextTime}return 108e3}function getData(){var ref=new Firebase("https://burning-heat-9490.firebaseio.com/");ref.on("value",function(snapshot){data=_.toArray(snapshot.val().Habits)},function(errorObject){data=[]})}function parseData(){for(var today=new Date,currentTime=toSecond(today.getHours()+":"+today.getMinutes()),i=0;i<data.length;i++){var from=toSecond(data[i].from),to=toSecond(data[i].to);-1!=checkDayInterval(data[i])?data[i].next_reminder_time=calculateNextTime(currentTime,from,to,data[i].time_interval):data[i].next_reminder_time=108e3}data=_.sortBy(data,"next_reminder_time")}function reminder(){if(data.length){count>0&&(count--,parseData(data));var today=new Date,currentTime=toSecond(today.getHours()+":"+today.getMinutes());if(currentTime==data[0].next_reminder_time){var item=data.shift();Notification.requestPermission();var theBody="It's time to complete "+item.title,theIcon="../img/logo.png",theTitle="Virtue/Vice";spawnNotification(theBody,theIcon,theTitle),item.next_reminder_time=calculateNextTime(currentTime,item.from,item.to,item.time_interval),data.push(item),data=_.sortBy(data,"next_reminder_time")}}setTimeout(reminder,500)}function checkDayInterval(data){var d=new Date,day=d.getDay(),checkDay=_.findIndex(data.weekly_frequency,function(d){return d==day});return checkDay}function spawnNotification(theBody,theIcon,theTitle){var options={body:theBody,icon:theIcon},n=new Notification(theTitle,options);setTimeout(n.close.bind(n),3e3)}function toSecond(timeStr){var time=3600*timeStr.substr(0,timeStr.indexOf(":"));return time+=60*timeStr.substr(timeStr.indexOf(":")+1)}function calculateNextTime(currTime,from,to,n){if(currTime>=from&&to>=currTime&&0!=n){for(var nextTime=from,curr=currTime;curr>nextTime;)nextTime+=3600*n;if(to>=nextTime)return nextTime}return 108e3}function getData(){var ref=new Firebase("https://burning-heat-9490.firebaseio.com/");ref.on("value",function(snapshot){data=_.toArray(snapshot.val().Habits)},function(errorObject){data=[]})}function parseData(){for(var today=new Date,currentTime=toSecond(today.getHours()+":"+today.getMinutes()),i=0;i<data.length;i++){var from=toSecond(data[i].from),to=toSecond(data[i].to);-1!=checkDayInterval(data[i])?data[i].next_reminder_time=calculateNextTime(currentTime,from,to,data[i].time_interval):data[i].next_reminder_time=108e3}data=_.sortBy(data,"next_reminder_time")}function reminder(){if(data.length){count>0&&(count--,parseData(data));var today=new Date,currentTime=toSecond(today.getHours()+":"+today.getMinutes());if(currentTime==data[0].next_reminder_time){var item=data.shift();Notification.requestPermission();var theBody="It's time to complete "+item.title,theIcon="../img/logo.png",theTitle="Virtue/Vice";spawnNotification(theBody,theIcon,theTitle),item.next_reminder_time=calculateNextTime(currentTime,item.from,item.to,item.time_interval),data.push(item),data=_.sortBy(data,"next_reminder_time")}}setTimeout(reminder,500)}function checkDayInterval(data){var d=new Date,day=d.getDay(),checkDay=_.findIndex(data.weekly_frequency,function(d){return d==day});return checkDay}function spawnNotification(theBody,theIcon,theTitle){var options={body:theBody,icon:theIcon},n=new Notification(theTitle,options);setTimeout(n.close.bind(n),3e3)}function toSecond(timeStr){var time=3600*timeStr.substr(0,timeStr.indexOf(":"));return time+=60*timeStr.substr(timeStr.indexOf(":")+1)}function calculateNextTime(currTime,from,to,n){if(currTime>=from&&to>=currTime&&0!=n){for(var nextTime=from,curr=currTime;curr>nextTime;)nextTime+=3600*n;if(to>=nextTime)return nextTime}return 108e3}var data=[],count=1;getData();var data=[],count=1;getData();var data=[],count=1;getData();var data=[],count=1;getData();